/*! v1.0.3 - 05-01-2015 20:10 */
/*!
 * jQuery UI Dialog Extended
 *
 * Copyright 2013-2015, Felix Nagel (http://www.felixnagel.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/fnagel/jquery-ui-extensions
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.dialog.js
 */
(function(i){i.widget("ui.dialog",i.ui.dialog,{options:{height:200,closeModalOnClick:!0,forceFullscreen:!1,resizeOnWindowResize:!1,scrollWithViewport:!1,resizeAccordingToViewport:!0,resizeToBestPossibleSize:!1,useContentSize:!1,useAnimation:!0,animateOptions:{duration:500,queue:!1},resized:null},change:function(i,t,e,s){"boolean"!=typeof s&&(s=this.options.useAnimation),s?(this.setAriaLive(!0),this.element.one(this.widgetEventPrefix+"resized",this,function(t){t.data.element.html(i),t.data.setAriaLive(!1),t.data.focusTabbable()})):this.element.html(i),this.changeSize(t,e)},changeSize:function(i,t){this._setOptions({width:i,height:t})},_setOption:function(i,t){"width"===i&&(this._oldSize.width=t),"height"===i&&(this._oldSize.height=t),this.options.useAnimation&&this.options.useContentSize&&this._isVisible&&("width"===i&&(t+=this.uiDialog.width()-this.element.width()),"height"===i&&(t+=this.uiDialog.outerHeight()-this.element.height())),this._super(i,t)},_getSize:function(t){var e=this.options,s=i.position.getWithinInfo(e.position.of),h=s.height>=s.width?!0:!1,o={width:s.width-(this.uiDialog.outerWidth()-this.uiDialog.width()),height:s.height};return e.forceFullscreen?o:(e.resizeToBestPossibleSize&&(t=h?this._calcSize(t,o.width,"width","height"):this._calcSize(t,o.height,"height","width")),(e.resizeAccordingToViewport||e.resizeToBestPossibleSize)&&(o.width<t.width&&(t=this._calcSize(t,o.width,"width","height")),o.height<t.height&&(t=this._calcSize(t,o.height,"height","width"))),t)},_calcSize:function(i,t,e,s){var h={};return h[s]=Math.max(0,i[s]/i[e]*t),h[e]=t,h},_size:function(){return i.extend(this.options,this._getSize(this.options)),this._isVisible&&this.options.useAnimation?(this._animateSize(),void 0):this.options.useContentSize?(this._contentSize(),void 0):(this._super(),void 0)},_contentSize:function(){var t,e,s,h=this.options;e=this.element.show().css({width:h.width,minHeight:0,maxHeight:"none",height:0}).outerWidth()-h.width,this.element.css("width","auto"),h.minWidth>h.width+e&&(h.width=h.minWidth),t=this.uiDialog.css({height:"auto",width:h.width+e}).outerHeight(),s=this._getSize({width:h.width+e,height:h.height+t}),this.uiDialog.css("width",s.width),this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight()),i.extend(h,s)},_animateUsing:function(t,e){var s=this;t.left=e.target.left+(e.target.width-this.options.width-(this.uiDialog.outerWidth()-this.uiDialog.width()))/2,t.top=e.target.top+(e.target.height-this.options.height)/2,0>t.top&&(t.top=0),this.uiDialog.animate(t,i.extend({},this.options.animateOptions,{complete:function(){s._trigger("resized")}}))},_animateSize:function(){var i=this.options;this.uiDialog.animate({width:i.width},i.animateOptions),this.element.animate({height:i.height-(this.uiDialog.outerHeight()-this.element.height())},i.animateOptions)},_position:function(){var i=this;this._positionOptions=this.options.position,this.options.useAnimation&&this._isVisible&&(this.options.position.using=function(t,e){i._animateUsing(t,e)}),this._super(),this.options.position=this._positionOptions},setAriaLive:function(i){this.uiDialog.attr({"aria-live":"assertive","aria-relevant":"additions removals text","aria-busy":i})},_create:function(){this._super(),this._isVisible=!1,this._oldSize={width:this.options.width,height:this.options.height},this._on(window,this._windowResizeEvents)},_windowResizeEvents:{resize:function(){this.options.resizeOnWindowResize&&this._addTimeout(function(){this._setOptions(this._oldSize)})},scroll:function(){this.options.scrollWithViewport&&this.timeout?this._addTimeout(function(){this._position()}):this.timeout=!0}},_addTimeout:function(i){clearTimeout(this.timeout),this._isVisible&&(this.timeout=this._delay(i,250))},_makeResizable:function(){this._super(),this.element.on(this.widgetEventPrefix+"resizestop",this,function(i){i.data.element.css("width","auto"),i.data.uiDialog.css("height","auto")})},_makeDraggable:function(){this._super(),this.element.on(this.widgetEventPrefix+"dragstop",this,function(i){i.data.options.position=i.data._positionOptions})},open:function(){this._super(),this._isVisible=!0},close:function(){this._super(),this._isVisible=!1},focusTabbable:function(){this._focusTabbable()},_createOverlay:function(){this._super(),this.options.modal&&this.options.closeModalOnClick&&this._on(this.overlay,{mousedown:function(i){this.close(i)}})}})})(jQuery);