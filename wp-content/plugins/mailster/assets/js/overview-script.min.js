mailster=function(t,a,e,s){"use strict";var n=[],i=false,r=a("tr.type-newsletter"),o=a("#bulk-action-selector-top"),c=a("#bulk-action-selector-bottom");a("#posts-filter").on("submit",function(){var a=o.val(),e=c.val(),s=a!=-1?a:e!=-1?e:false;switch(s){case"finish":return confirm(t.l10n.campaigns.finish_campaigns);break;case"start":return confirm(t.l10n.campaigns.start_campaigns);break}});a(".column-status").on("click","a.live-action",function(){if(a(this).hasClass("finish")&&!confirm(t.l10n.campaigns.finish_campaign)){return false}var e=a(this).parent().parent().parent().addClass("loading");a.get(a(this).attr("href"),function(){setTimeout(function(){wp.heartbeat.connectNow()},500)});return false});t.$.document.on("scroll",function(){clearTimeout(i);i=setTimeout(function(){wp.heartbeat.connectNow()},400)}).on("heartbeat-send",function(e,s){var i=[],o;r.each(function(){o=parseInt(a(this).find("input").eq(0).val(),10);n[o]=n[o]||{};if(t.util.inViewport(this))i.push(o)});s["mailster"]={page:"overview",ids:i}}).on("heartbeat-tick",function(t,e){var s=false;if(e["mailster"]){if(!n){n=a.extend(e["mailster"],n);s=true}var i=false,o=0;a.each(r,function(t,r){var c;r=a(r);t=r.attr("id").replace("post-","");r.removeClass("loading");if(!e["mailster"][t])return;c=e["mailster"][t];r.find(".column-status")[c.cron?"removeClass":"addClass"]("cron-issue");r.find(".campaign-status").html(c.cron?"":c.status_title);a.each(c,function(a,e){if(!s&&n[t][a]==e)return;var l=n[t]&&n[t].status&&(c.status!=n[t].status||c.is_active!=n[t].is_active);switch(a){case"status":if(l){r.removeClass("status-"+n[t].status).addClass("status-"+c.status)}case"sent":case"total":case"sent_formatted":break;case"column-status":if(c.status=="active"&&!l){var f=r.find(".campaign-progress"),u=c.sent/c.total*100;f.find(".bar").width(u+"%");f.find("span").eq(1).html(c.sent_formatted);f.find("span").eq(2).html(c.sent_formatted);f.find("var").html(Math.round(u)+"%")}if(!l)break;default:var m=r.find("."+a);if(!m.is(":visible"))break;m.fadeTo(10,.01,function(){m.html(e).delay(10*o++).fadeTo(200,1)})}i=true})});if(i)wp.heartbeat.interval("fast");n=a.extend(n,e["mailster"])}});wp.heartbeat.interval("fast");if(wp.heartbeat.connectNow)wp.heartbeat.connectNow();return t}(mailster||{},jQuery,window,document);