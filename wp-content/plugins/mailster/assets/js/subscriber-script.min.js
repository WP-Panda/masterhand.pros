mailster=function(e,i,t,a){"use strict";var s,r=i("#email"),o=i("#ID").val(),n=i(".avatar"),l=i("form#subscriber_form");i.easyPieChart&&i(".piechart").easyPieChart({animate:1e3,rotate:180,barColor:e.colors.main,trackColor:e.colors.track_light,lineWidth:9,size:75,lineCap:"butt",onStep:function(e){this.$el.find("span").text(Math.round(e))},onStop:function(e){this.$el.find("span").text(Math.round(e))}});i("#subscriber_form").on("submit",function(){clearTimeout(s);r.off("blur").off("keyup");i(this).submit(false)});i(".detail").on("click",function(){var e=i(this).addClass("active"),t=e.find(".click-to-edit"),a=t.find("> li").first(),s=t.find("> li").last();if(!a.is(":hidden")){a.hide();s.show().find("input").first().focus().select();s.show().find("textarea").first().focus().select()}});i("#mailster_status").on("change",function(){if(i(this).val()<=0){i(".pending-info").show()}else{i(".pending-info").hide()}});i(".show-more-info").on("click",function(){i(".more-info").slideToggle(100)});i(".map.zoomable").on("click",function(){var e=i(this),t=e.find("img");if(!t.hasClass("zoomed")){t.attr("src",t.attr("src").replace(/zoom=\d+/,"zoom=11")).addClass("zoomed")}else{t.attr("src",t.attr("src").replace(/zoom=\d+/,"zoom=5")).removeClass("zoomed")}});i.datepicker&&i("input.datepicker").datepicker({dateFormat:"yy-mm-dd",firstDay:e.l10n.subscribers.start_of_week,dayNames:e.l10n.subscribers.day_names,dayNamesMin:e.l10n.subscribers.day_names_min,monthNames:e.l10n.subscribers.month_names,prevText:e.l10n.subscribers.prev,nextText:e.l10n.subscribers.next,showAnim:"fadeIn",onClose:function(){var e=i(this).datepicker("getDate");i(".deliverydate").html(i(this).val())}});r.on("blur",function(){var t=i(this),a=e.util.trim(t.val());i(this).val(a);if(n.data("email")!=a){n.addClass("avatar-loading");c(a,function(e){if(e.success)n.data("email",a).removeClass("avatar-loading").css({"background-image":"url("+e.url.replace(/&amp;/,"&")+")"})})}if(!a)l.prop("disabled",true);t.trigger("keyup")}).on("keyup",function(){var t=i(this);clearTimeout(s);s=setTimeout(function(){var a=e.util.trim(t.val());e.util.ajax("check_email",{email:a,id:o},function(a){l.prop("disabled",a.exists);i(".email-error").slideUp(100,function(){i(this).remove()});if(a.exists){i('<p class="email-error">&#9650; '+e.l10n.subscribers.email_exists+"</p>").hide().insertAfter(t).slideDown(100);setTimeout(function(){t.focus(),1})}})},400);l.prop("disabled",true)});function c(i,t){e.util.ajax("get_gravatar",{email:i},t)}return e}(mailster||{},jQuery,window,document);