mailster=function(t,i,e,n){"use strict";var a=i(".mailster-setup-step"),s,l,d=i(".status"),r=i(".spinner"),c=location.hash.substr(1);if(c&&i("#step_"+c).length){s=i("#step_"+c)}else{s=a.eq(0)}l=s.attr("id").replace(/^step_/,"");a.hide();f(l);i("form.mailster-setup-step-form").on("submit",function(){i(".next-step:visible").hide();return false});i("#mailster-setup").on("click",".validation-skip-step",function(){return confirm(t.l10n.setup.skip_validation)}).on("click",".next-step",function(){if(i(this).hasClass("disabled"))return false;if(tinymce)tinymce.get("post_content").save();var e=i(this).parent().parent().find("form"),n=e.serialize();t.util.ajax("wizard_save",{id:l,data:n},function(t){})}).on("click",".load-language",function(){d.html(t.l10n.setup.load_language);r.css("visibility","visible");t.util.ajax("load_language",function(t){r.css("visibility","hidden");d.html(t.html);if(t.success){location.reload()}});return false}).on("click",".quick-install",function(){var t=i(this);v(t.data("plugin"),t.data("method"),t.parent())}).on("click",".edit-slug",function(){i(this).parent().parent().find("span").hide().filter(".edit-slug-area").show().find("input").focus().select()});t.$.document.on("verified.mailster",function(){i(".validation-next-step").removeClass("disabled");i(".validation-skip-step").addClass("disabled")});h();var u=i("#deliverynav"),o=i(".deliverytab");u.on("click","a.nav-tab",function(){u.find("a").removeClass("nav-tab-active");o.hide();var e=i(this).addClass("nav-tab-active").attr("href").substr(1);i("#deliverymethod").val(e);i("#deliverytab-"+e).show();if(i("#deliverytab-"+e).find(".quick-install").length){i(".delivery-next-step").addClass("disabled").html(sprintf(t.l10n.setup.enable_first,i(this).html()))}else{i(".delivery-next-step").removeClass("disabled").html(sprintf(t.l10n.setup.use_deliverymethod,i(this).html()))}return false});t.$.window.on("hashchange",function(){var e=location.hash.substr(1)||"start",n=i(".mailster-setup-steps-nav").find("a[href='#"+e+"']"),a,s;if(n.length){f(e);n.parent().parent().find("a").removeClass("next prev current");n.parent().prevAll().find("a").addClass("prev");n.addClass("current");if(tinymce&&tinymce.activeEditor)tinymce.activeEditor.theme.resizeTo("100%",200)}if("finish"==e){t.util.ajax("wizard_save",{id:e,data:null})}});t.events.push("documentReady",function(){t.$.window.trigger("hashchange")});function h(){d.html(t.l10n.setup.check_language);r.css("visibility","visible");t.util.ajax("check_language",function(t){r.css("visibility","hidden");d.html(t.html);if(t.success){}})}function f(t){var e=i("#step_"+t);if(e.length){s.hide();s=e;s.show();l=t}}function v(i,e,n,a){d.html(t.l10n.setup.install_addon);r.css("visibility","visible");t.util.ajax("quick_install",{plugin:i,method:e,step:"install"},function(a){d.html(t.l10n.setup.activate_addon);t.util.ajax("quick_install",{plugin:i,method:e,step:"activate"},function(a){d.html(t.l10n.setup.receiving_content);t.util.ajax("quick_install",{plugin:i,method:e,step:"content"},function(t){d.html("");r.css("visibility","hidden");n.html(t.content);u.find("a.nav-tab-active").trigger("click")})})})}return t}(mailster||{},jQuery,window,document);