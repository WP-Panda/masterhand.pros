mailster=function(r,s,i,n){"use strict";r.conditions=r.conditions||{};s.each(s(".mailster-conditions"),function(){var n=s(this),t=n.find(".mailster-conditions-wrap"),o=n.find(".mailster-condition-group"),a=n.find(".mailster-condition");o.eq(0).appendTo(n.find(".mailster-condition-container"));!r.util.trim(t.html())&&t.empty();d();n.on("click",".add-condition",function(){var e=o.length,i=o.eq(0).clone();i.removeAttr("id").appendTo(t).data("id",e).show();s.each(i.find("input, select"),function(){var i=s(this),n=i.attr("name");i.attr("name",n.replace(/\[\d+\]/,"["+e+"]")).prop("disabled",false)});i.find(".condition-field").val("").focus();d();o=n.find(".mailster-condition-group");a=n.find(".mailster-condition")}).on("click",".add-or-condition",function(){var e=s(this).parent(),t=e.find(".mailster-condition").last().data("id"),i=a.eq(0).clone();i.removeAttr("id").appendTo(e).data("id",++t);s.each(i.find("input, select"),function(){var i=s(this),n=i.attr("name");i.attr("name",n.replace(/\[\d+\]\[\d+\]/,"["+e.data("id")+"]["+t+"]")).prop("disabled",false)});i.find(".condition-field").val("").focus();d();a=n.find(".mailster-condition")});t.on("click",".remove-condition",function(){var i=s(this).parent();if(i.parent().find(".mailster-condition").length==1){i=i.parent()}i.slideUp(100,function(){s(this).remove();r.trigger("updateCount")})}).on("change",".condition-field",function(){var i=s(this).closest(".mailster-condition"),n=s(this).val(),e,t;i.find("div.mailster-conditions-value-field").removeClass("active").find(".condition-value").prop("disabled",true);i.find("div.mailster-conditions-operator-field").removeClass("active").find(".condition-operator").prop("disabled",true);t=i.find('div.mailster-conditions-value-field[data-fields*=",'+n+',"]').addClass("active").find(".condition-value").prop("disabled",false);e=i.find('div.mailster-conditions-operator-field[data-fields*=",'+n+',"]').addClass("active").find(".condition-operator").prop("disabled",false);if(!t.length){t=i.find("div.mailster-conditions-value-field-default").addClass("active").find(".condition-value").prop("disabled",false)}if(!e.length){e=i.find("div.mailster-conditions-operator-field-default").addClass("active").find(".condition-operator").prop("disabled",false)}if(!t.val()){if(t.is(".hasDatepicker")){t.datepicker("setDate","yy-mm-dd")}}r.trigger("updateCount")}).on("change",".condition-operator",function(){r.trigger("updateCount")}).on("change",".condition-value",function(){r.trigger("updateCount")}).on("click",".mailster-condition-add-multiselect",function(){s(this).parent().clone().insertAfter(s(this).parent()).find(".condition-value").select().focus();return false}).on("click",".mailster-condition-remove-multiselect",function(){s(this).parent().remove();r.trigger("updateCount");return false}).on("change",".mailster-conditions-value-field-multiselect > .condition-value",function(){if(0==s(this).val()&&s(this).parent().parent().find(".condition-value").size()>1)s(this).parent().remove()}).on("click",".mailster-rating > span",function(i){var n=s(this),e=n.prevAll(),t=n.siblings();t.removeClass("enabled");e.add(n).addClass("enabled");n.parent().parent().find(".condition-value").val((e.length+1)/5).trigger("change")}).find(".condition-field").prop("disabled",false).trigger("change");r.trigger("updateCount");function d(){t.find(".datepicker").datepicker({dateFormat:"yy-mm-dd",firstDay:r.l10n.conditions.start_of_week,showWeek:true,dayNames:r.l10n.conditions.day_names,dayNamesMin:r.l10n.conditions.day_names_min,monthNames:r.l10n.conditions.month_names,prevText:r.l10n.conditions.prev,nextText:r.l10n.conditions.next,showAnim:"fadeIn"})}});return r}(mailster||{},jQuery,window,document);